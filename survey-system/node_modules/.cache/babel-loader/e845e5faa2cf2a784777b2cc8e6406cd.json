{"ast":null,"code":"var _jsxFileName = \"C:\\\\Development\\\\Survey System\\\\survey-system\\\\src\\\\components\\\\Categories\\\\Categories.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { Header } from \"../Header/Header\";\nimport categories from '../Data/PetsCategories';\nimport { PetsCard } from \"../PetsCards/PetsCards\";\nimport dogQuestions from \"../Data/Questions.json\";\nimport Elements from \"../Data/QuestionsAnswers.json\";\nimport { AnswerLayout } from \"../AnswerOptions/AnswerLayout\";\nimport { SurveyCompleted } from \"./SurveyCompleted\";\nimport ElementService from \"../../services/ElementService\";\nimport AnswerService from \"../../services/AnswerService\";\nimport getTreeData from \"../../common/getTreeData\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const SurveyCategories = props => {\n  _s();\n\n  const elementsMap = Elements.map((parentElement, i) => {\n    return parentElement;\n  });\n  const answersTest = {\n    question: Elements[0].Name,\n    answers: Elements[0].children.map((child, i) => {\n      return child;\n    })\n  };\n  let treeRoot = 0;\n  const [getSurveyQuestions, setSurveyQuestions] = useState();\n  const [getRedirectQuestions, setRedirectQuestions] = useState(false);\n  const [getSelectedAnswer, setSelectedAnswer] = useState(); // const[getAnswers, setAnswers]= useState<any>(answersTest);\n\n  const [getCurrentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  /*  const[getNextQuestion, setNextQuestion]= useState<any>({\r\n        Id:Elements[treeRoot].Id,\r\n        Name:Elements[treeRoot].Name,\r\n        ParentId:Elements[treeRoot].ParentId,\r\n        children:Elements[treeRoot].children\r\n    });*/\n\n  const [getNextQuestion, setNextQuestion] = useState();\n  const [getCurrentQuestion, setCurrentQuestion] = useState();\n  const [IsNextQuestion, setIsNextQuestion] = useState(false);\n  const [getTypedResponses, setTypedResponses] = useState({\n    Id: 0,\n    value: ''\n  });\n  const [getAnswerList, setAnswerList] = useState([]);\n  const [getIsSurveyCompleted, setIsSurveyCompleted] = useState(false);\n  const elementService = new ElementService();\n  const answerService = new AnswerService();\n\n  const onAnswerClickHandler = option => {\n    //Find out if the answer have a child and render the child, if not move to the next question.\n    let tempAnswers = getAnswerList;\n    tempAnswers[option.parentId] = option.id;\n    setAnswerList(tempAnswers);\n\n    if (option.children.length > 0) {\n      setCurrentQuestion(option);\n      setIsNextQuestion(true);\n      console.log(option.children);\n    } else {\n      //   console.log(treeRoot);\n      setIsNextQuestion(false);\n      console.log(\"Incrementing state\");\n    }\n\n    setSelectedAnswer(option);\n    const elementsMap = Elements.map((parentElement, i) => {\n      return parentElement;\n    });\n  };\n\n  const onTypeTextValueHandler = (e, elementId) => {\n    console.log(getCurrentQuestionIndex);\n    var response = e.target.value;\n    let tempAnswers = getAnswerList;\n    tempAnswers[elementId] = response;\n    setAnswerList(tempAnswers);\n    console.log(tempAnswers);\n    /* let answer={id:elementId, answerText: response};\r\n     const answerList=[...getAnswerList];\r\n     answerList.push(answer);*/\n    //setTypedResponses({Id: elementId, value:response});\n\n    setIsNextQuestion(false); //console.log(elementId);\n\n    /*const onchangeInput = (val, index) =>{\r\n    temp[index] = val.target.value\r\n    console.log(temp)*/\n  };\n\n  const onNextQuestionClickHandler = () => {\n    //Debugging logs\n    console.log(getCurrentQuestionIndex); // console.log(getTypedResponses);\n\n    console.log(getAnswerList); //Move to the next child node.\n\n    if (IsNextQuestion) {\n      setNextQuestion(getCurrentQuestion);\n    } else {\n      //Move to the next root parent node.\n      let nextIndex = getCurrentQuestionIndex;\n      nextIndex++;\n      setCurrentQuestionIndex(nextIndex);\n\n      if (getSurveyQuestions[nextIndex]) {\n        setNextQuestion({\n          Id: getSurveyQuestions[nextIndex].id,\n          Name: getSurveyQuestions[nextIndex].name,\n          ParentId: getSurveyQuestions[nextIndex].parentId,\n          children: getSurveyQuestions[nextIndex].children\n        });\n      } else {\n        setRedirectQuestions(false); //Save questions.\n\n        SaveAnswerList();\n        setIsSurveyCompleted(true);\n      }\n    } // setCurrentQuestion(getNextQuestion);\n    //Find within the tree which question has the Id of next question and deploy it.\n    //setCurrentQuestionIndex(getCurrentQuestionIndex+1);\n\n  };\n\n  const onCategoryClickHandler = (e, id) => {\n    //Load Axios with questions from backend.\n    const fetchQuestionList = async () => {\n      const questionList = await elementService.GetElementListByCategory(id);\n\n      if (questionList) {\n        var treeData = getTreeData(questionList);\n        console.log(getTreeData(questionList));\n        setSurveyQuestions(treeData);\n        console.log({\n          Id: treeData[treeRoot].id,\n          Name: treeData[treeRoot].name,\n          ParentId: treeData[treeRoot].parentId,\n          children: treeData[treeRoot].children\n        });\n        setNextQuestion({\n          Id: treeData[treeRoot].id,\n          Name: treeData[treeRoot].name,\n          ParentId: treeData[treeRoot].parentId,\n          children: treeData[treeRoot].children\n        });\n      }\n\n      ;\n    };\n\n    fetchQuestionList();\n    setRedirectQuestions(true);\n    console.log(dogQuestions);\n  };\n\n  const SaveAnswerList = async () => {\n    let answers = [];\n    let answersToSave = getAnswerList.map(answer => {\n      // console.log({ParentId: getAnswerList.indexOf(answer), ElementId:answer});\n      return answers.push({\n        ParentId: getAnswerList.indexOf(answer),\n        ElementId: answer\n      });\n    });\n    console.log(answers);\n    /*  const response = await answerService.PostElements(getAnswerList) as any;\r\n      if (response) {\r\n         alert(response);\r\n      }*/\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: getIsSurveyCompleted ? /*#__PURE__*/_jsxDEV(SurveyCompleted, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: getRedirectQuestions && getNextQuestion ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Header, {\n          children: getNextQuestion.Name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center mt-16\",\n          children: /*#__PURE__*/_jsxDEV(AnswerLayout, {\n            answers: getNextQuestion.children,\n            onClick: onAnswerClickHandler,\n            onNextQuestionClickHandler: onNextQuestionClickHandler,\n            onTypeTextReponseValue: onTypeTextValueHandler\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 17\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Header, {\n          children: \"Choose a survey to get started\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-row flex-wrap justify-center mt-16\",\n          children: categories && categories.map((element, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: e => onCategoryClickHandler(e, element.Id),\n            children: /*#__PURE__*/_jsxDEV(PetsCard, {\n              imgSrc: element.ImgSrc,\n              imgAlt: element.ImgAlt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 25\n            }, this)\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 21\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 6\n    }, this)\n  }, void 0, false);\n};\n\n_s(SurveyCategories, \"70ldae68pyEinahqpFjml+2IDv4=\");\n\n_c = SurveyCategories;\n\nvar _c;\n\n$RefreshReg$(_c, \"SurveyCategories\");","map":{"version":3,"sources":["C:/Development/Survey System/survey-system/src/components/Categories/Categories.tsx"],"names":["React","useState","Header","categories","PetsCard","dogQuestions","Elements","AnswerLayout","SurveyCompleted","ElementService","AnswerService","getTreeData","SurveyCategories","props","elementsMap","map","parentElement","i","answersTest","question","Name","answers","children","child","treeRoot","getSurveyQuestions","setSurveyQuestions","getRedirectQuestions","setRedirectQuestions","getSelectedAnswer","setSelectedAnswer","getCurrentQuestionIndex","setCurrentQuestionIndex","getNextQuestion","setNextQuestion","getCurrentQuestion","setCurrentQuestion","IsNextQuestion","setIsNextQuestion","getTypedResponses","setTypedResponses","Id","value","getAnswerList","setAnswerList","getIsSurveyCompleted","setIsSurveyCompleted","elementService","answerService","onAnswerClickHandler","option","tempAnswers","parentId","id","length","console","log","onTypeTextValueHandler","e","elementId","response","target","onNextQuestionClickHandler","nextIndex","name","ParentId","SaveAnswerList","onCategoryClickHandler","fetchQuestionList","questionList","GetElementListByCategory","treeData","answersToSave","answer","push","indexOf","ElementId","element","ImgSrc","ImgAlt"],"mappings":"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","sourcesContent":["import React, { FC, useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Header } from \"../Header/Header\";\r\nimport categories from '../Data/PetsCategories';\r\nimport { PetsCard } from \"../PetsCards/PetsCards\";\r\nimport dogQuestions from \"../Data/Questions.json\";\r\nimport { Test1 } from \"../Tests/Test1\";\r\nimport ExampleList from \"../Data/Example.json\";\r\nimport Elements from \"../Data/QuestionsAnswers.json\";\r\nimport { AnswerLayout } from \"../AnswerOptions/AnswerLayout\";\r\nimport { SurveyCompleted } from \"./SurveyCompleted\";\r\nimport ElementService from \"../../services/ElementService\";\r\nimport AnswerService from \"../../services/AnswerService\";\r\nimport getTreeData from \"../../common/getTreeData\";\r\nimport { getMaxListeners } from \"process\";\r\n\r\n\r\n\r\nexport interface IProps {\r\n   \r\n}\r\n\r\n\r\nexport const SurveyCategories: FC<IProps> = (props: IProps) => {   \r\n    const elementsMap =Elements.map((parentElement:any, i:number)=>{\r\n        return parentElement\r\n     })\r\n\r\n     const answersTest= {\r\n        question: Elements[0].Name,\r\n        answers:Elements[0].children.map((child:any, i:number)=>{\r\n           return child\r\n        })\r\n\r\n    }\r\n   \r\n    let treeRoot=0;\r\n\r\n    const[getSurveyQuestions, setSurveyQuestions]= useState<any>();\r\n    const[getRedirectQuestions, setRedirectQuestions]= useState<boolean>(false);\r\n    const[getSelectedAnswer, setSelectedAnswer] =  useState<any>();\r\n   // const[getAnswers, setAnswers]= useState<any>(answersTest);\r\n    const[getCurrentQuestionIndex, setCurrentQuestionIndex]= useState<number>(0);\r\n  /*  const[getNextQuestion, setNextQuestion]= useState<any>({\r\n        Id:Elements[treeRoot].Id,\r\n        Name:Elements[treeRoot].Name,\r\n        ParentId:Elements[treeRoot].ParentId,\r\n        children:Elements[treeRoot].children\r\n    });*/\r\n    const[getNextQuestion, setNextQuestion]= useState<any>();\r\n    const[getCurrentQuestion, setCurrentQuestion]= useState<any>();\r\n    const[IsNextQuestion, setIsNextQuestion]=useState<boolean>(false);\r\n    const[getTypedResponses, setTypedResponses]= useState<any>({Id:0, value:''});\r\n    const[getAnswerList, setAnswerList]= useState<any>([]);\r\n    const[getIsSurveyCompleted, setIsSurveyCompleted]=useState<boolean>(false);\r\n    const elementService= new ElementService();\r\n    const answerService= new AnswerService();\r\n  \r\n   \r\n   \r\n    const onAnswerClickHandler =(option:any) => {\r\n     //Find out if the answer have a child and render the child, if not move to the next question.\r\n     let tempAnswers = getAnswerList;\r\n     tempAnswers[option.parentId] = option.id;\r\n     setAnswerList(tempAnswers);\r\n\r\n     if(option.children.length> 0){\r\n         setCurrentQuestion(option)\r\n         setIsNextQuestion(true);\r\n         console.log(option.children);\r\n     }\r\n     else{\r\n     //   console.log(treeRoot);\r\n        setIsNextQuestion(false);\r\n        console.log(\"Incrementing state\");\r\n     \r\n\r\n     }\r\n      setSelectedAnswer(option);\r\n      const elementsMap =Elements.map((parentElement:any, i:number)=>{\r\n        return parentElement\r\n     })\r\n    }\r\n\r\n\r\n    const onTypeTextValueHandler=(e:any, elementId:number)=>{\r\n        console.log(getCurrentQuestionIndex);\r\n        var response = e.target.value;\r\n        let tempAnswers = getAnswerList;\r\n        tempAnswers[elementId] = response;\r\n        setAnswerList(tempAnswers);\r\n        console.log(tempAnswers)\r\n       /* let answer={id:elementId, answerText: response};\r\n        const answerList=[...getAnswerList];\r\n        answerList.push(answer);*/\r\n        //setTypedResponses({Id: elementId, value:response});\r\n        setIsNextQuestion(false);\r\n        \r\n        //console.log(elementId);\r\n    /*const onchangeInput = (val, index) =>{\r\n    temp[index] = val.target.value\r\n    console.log(temp)*/\r\n    }\r\n\r\n    const onNextQuestionClickHandler=()=>{\r\n        //Debugging logs\r\n        console.log(getCurrentQuestionIndex);\r\n       // console.log(getTypedResponses);\r\n        console.log(getAnswerList);\r\n\r\n        //Move to the next child node.\r\n        if(IsNextQuestion){\r\n            setNextQuestion(getCurrentQuestion);\r\n        }\r\n        else{\r\n         //Move to the next root parent node.\r\n           let nextIndex:number=getCurrentQuestionIndex;\r\n           nextIndex++;\r\n           setCurrentQuestionIndex(nextIndex);\r\n           if(getSurveyQuestions[nextIndex]){\r\n                setNextQuestion({\r\n                    Id:getSurveyQuestions[nextIndex].id,\r\n                    Name:getSurveyQuestions[nextIndex].name,\r\n                    ParentId:getSurveyQuestions[nextIndex].parentId,\r\n                    children:getSurveyQuestions[nextIndex].children\r\n                });\r\n           }\r\n           else{\r\n               setRedirectQuestions(false);\r\n               //Save questions.\r\n               SaveAnswerList();\r\n               setIsSurveyCompleted(true);\r\n\r\n\r\n           }\r\n    }\r\n       // setCurrentQuestion(getNextQuestion);\r\n        //Find within the tree which question has the Id of next question and deploy it.\r\n        //setCurrentQuestionIndex(getCurrentQuestionIndex+1);\r\n    }\r\n    const onCategoryClickHandler =(e:any, id:number)=>{\r\n\r\n                //Load Axios with questions from backend.\r\n                const fetchQuestionList = async () => {\r\n                    const questionList = await elementService.GetElementListByCategory(id) as [];\r\n                    if (questionList) {\r\n                    var treeData= getTreeData(questionList);\r\n                    console.log(getTreeData(questionList));\r\n                    setSurveyQuestions(treeData);\r\n                   console.log( {\r\n                    Id:treeData[treeRoot].id,\r\n                    Name:treeData[treeRoot].name,\r\n                    ParentId:treeData[treeRoot].parentId,\r\n                    children:treeData[treeRoot].children\r\n                    });\r\n                    setNextQuestion({\r\n                        Id:treeData[treeRoot].id,\r\n                        Name:treeData[treeRoot].name,\r\n                        ParentId:treeData[treeRoot].parentId,\r\n                        children:treeData[treeRoot].children\r\n                    });\r\n                     \r\n                    };\r\n                  };\r\n                fetchQuestionList();\r\n                setRedirectQuestions(true);\r\n                console.log(dogQuestions);\r\n        }\r\n\r\n        const SaveAnswerList = async () => {\r\n            let answers:any=[]\r\n            let answersToSave= getAnswerList.map((answer:any)=>{\r\n               // console.log({ParentId: getAnswerList.indexOf(answer), ElementId:answer});\r\n                return answers.push({ParentId: getAnswerList.indexOf(answer), ElementId:answer}); \r\n            })\r\n            console.log(answers);\r\n          /*  const response = await answerService.PostElements(getAnswerList) as any;\r\n            if (response) {\r\n               alert(response);\r\n            }*/\r\n\r\n          };\r\n\r\n    return (\r\n        <>\r\n\r\n     {getIsSurveyCompleted?\r\n            <SurveyCompleted/>\r\n     :\r\n     <div>\r\n        {getRedirectQuestions && getNextQuestion\r\n                ? \r\n                <div>\r\n                    <Header>{getNextQuestion.Name}</Header>\r\n                        <div className=\"flex justify-center mt-16\">\r\n                            <AnswerLayout answers={getNextQuestion.children} onClick={onAnswerClickHandler} onNextQuestionClickHandler={onNextQuestionClickHandler} onTypeTextReponseValue={onTypeTextValueHandler}/>\r\n                        </div>\r\n                </div>\r\n            \r\n                : \r\n                <div>\r\n                <Header>Choose a survey to get started</Header>\r\n                <div className=\"flex flex-row flex-wrap justify-center mt-16\">\r\n                    {categories && categories.map((element:any, i:any)=>\r\n                    <div key={i} onClick={(e:any)=> onCategoryClickHandler(e, element.Id)}>\r\n                        <PetsCard imgSrc={element.ImgSrc} imgAlt={element.ImgAlt} ></PetsCard>\r\n                    </div>\r\n                    )}\r\n                </div>\r\n        </div>\r\n      }\t\r\n         </div>\r\n     \r\n     }\r\n     \t  \r\n         </>\r\n    );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}